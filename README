This is the source for DeskScop. See http://www.reincubate.com/labs/deskscop-spamcop-desktop/. Yes, it would be much nicer with a few regexps.